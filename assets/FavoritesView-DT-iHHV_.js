import{X as q,_ as D,P as I}from"./FAB-B9lZLoyu.js";import{_ as O}from"./SubPageLayout-BQkCqbUB.js";import{r as v,y as E,d as x,c as $,o as d,w as V,h as m,B as A,a as c,t as g,N as L,j as y,l as F,F as B,k as M,b as h,n as k,u as b,m as T,I as j,e as z,f as C}from"./index-B3fSrwim.js";import{_ as N}from"./Modal-C4Bhvrem.js";import{_ as w}from"./TextField-CPm8t0_q.js";import{_ as S}from"./SelectField-IySsiNI7.js";const U={__name:"Form",props:{favorite:{type:Object,default:null},accounts:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]}},emits:["close"],setup(f,{emit:u}){const r=f,p=u,i={id:null,label:"",amount:null,categoryId:"",accountId:""},e=v({...i});E(()=>r.favorite,o=>{o!=null&&o.id?e.value={...o}:e.value={...i}},{immediate:!0});const t=x(()=>r.categories.map(o=>({label:o.name+` (${o.type})`,value:o.id}))),n=x(()=>[{label:"Out Source / Cash",value:""},...r.accounts.map(o=>({label:o.name+` (${o.type})`,value:o.id}))]),s=async()=>{var a;const o=JSON.parse(JSON.stringify(e.value));o.id||delete o.id;const l=await A("favorites",o);l.success?((a=document.querySelector("#manage-favorites-form"))==null||a.close(),p("close")):console.error("Failed to save favorite:",l.error)};return(o,l)=>(d(),$(N,{id:"manage-favorites-form",modalTitle:"Favorite",isForm:"",submit:s,closeLabel:"Cancel"},{default:V(()=>[m(w,{modelValue:e.value.label,"onUpdate:modelValue":l[0]||(l[0]=a=>e.value.label=a),label:"Label",required:"",placeholder:"Grocery, Salary, Dinner..."},null,8,["modelValue"]),m(w,{modelValue:e.value.amount,"onUpdate:modelValue":l[1]||(l[1]=a=>e.value.amount=a),modelModifiers:{number:!0},label:"Amount",type:"number",placeholder:"0.00",required:""},null,8,["modelValue"]),m(S,{modelValue:e.value.categoryId,"onUpdate:modelValue":l[2]||(l[2]=a=>e.value.categoryId=a),options:t.value,label:"Category",required:""},null,8,["modelValue","options"]),m(S,{modelValue:e.value.accountId,"onUpdate:modelValue":l[3]||(l[3]=a=>e.value.accountId=a),options:n.value,label:"Account",required:""},null,8,["modelValue","options"])]),_:1}))}},J={class:"font-bold text-center py-2"},P={__name:"DeleteForm",props:{favorite:{type:Object,default:null}},emits:["close"],setup(f,{emit:u}){const r=f,p=u,i=async()=>{var t;const e=await L("favorites",r.favorite.id);e.success?((t=document.querySelector("#delete-favorite-form"))==null||t.close(),p("close")):console.error("Failed to delete favorite:",e.error)};return(e,t)=>(d(),$(N,{id:"delete-favorite-form",modalTitle:"Delete Favorite",isForm:"",closeLabel:"Cancel",submit:i,isDanger:"",formButtonLabel:"Confirm"},{default:V(()=>{var n;return[t[0]||(t[0]=c("p",{class:"text-center text-balance"},"Are you sure you want to delete this favorite?",-1)),c("p",J,g((n=f.favorite)==null?void 0:n.label),1)]}),_:1}))}},G={class:"list bg-base-100 rounded-box shadow-md mb-6"},R=["onClick"],X={class:"flex gap-2 items-center mt-1"},H={class:"text-xs font-semibold"},K={key:1,class:"opacity-50"},Q=["onClick"],W={key:0},Y={class:"p-2"},Z={class:"alert alert-warning alert-soft"},ee={__name:"List",props:["favorites","accounts","categories"],emits:["form","delete"],setup(f){const u=f,r=e=>{var t;return e?(t=u.accounts)==null?void 0:t.find(n=>n.id===e):null},p=e=>{var t;return e?(t=u.categories)==null?void 0:t.find(n=>n.id===e):null},i=x(()=>{const e=[];return u.favorites.forEach(t=>{t.account=r(t.accountId),t.category=p(t.categoryId),e.push(t)}),e.sort((t,n)=>{var s,o,l,a;return((s=t.category)==null?void 0:s.type)===((o=n.category)==null?void 0:o.type)?t.label.localeCompare(n.label):(((l=t.category)==null?void 0:l.type)||"").localeCompare(((a=n.category)==null?void 0:a.type)||"")})});return(e,t)=>{var n;return d(),y("div",null,[c("ul",G,[(d(!0),y(B,null,M(i.value,s=>(d(),y("li",{class:"list-row flex justify-between hover:bg-base-300 select-none",key:s.id},[c("div",{onClick:o=>e.$emit("form",s),class:"flex gap-4 w-full"},[c("div",null,[c("div",null,[h(g(s.label)+" ",1),s.category?(d(),y("span",{key:0,class:k(["text-white",{"badge badge-sm badge-primary":s.category.type==="Income","badge badge-sm badge-error":s.category.type==="Expense"}])},g(`${s.category.name} (${s.category.type})`),3)):F("",!0)]),c("div",X,[c("div",H,[h(g(b(T)(s.amount))+" ",1),s.account?(d(),y("span",{key:0,class:k({"text-warning":s.account.type==="Credit","text-secondary":s.account.type==="Debit"})},g(`${s.account.name} (${s.account.type})`),3)):(d(),y("span",K,"Out Source"))])])])],8,R),c("button",{class:"btn btn-square btn-sm btn-ghost text-error",onClick:o=>e.$emit("delete",s)},[m(b(q),{size:"16"})],8,Q)]))),128)),(n=f.favorites)!=null&&n.length?F("",!0):(d(),y("li",W,[c("div",Y,[c("div",Z,[m(b(j),{size:"16"}),t[0]||(t[0]=c("span",null,"No favorites yet",-1))])])]))])])}}},te="favorites",ce={__name:"FavoritesView",setup(f){const u=v([]),r=v(null),p=v([]),i=v([]),e=async()=>{u.value=await C(te)},t=async()=>{p.value=await C("accounts"),i.value=await C("categories")},n=(l=null)=>{var a;r.value=l,(a=document.querySelector("#manage-favorites-form"))==null||a.showModal()},s=l=>{var a;r.value=l,(a=document.querySelector("#delete-favorite-form"))==null||a.showModal()},o=()=>{e()};return z(()=>{e(),t()}),(l,a)=>(d(),$(O,{pageTitle:"Favorites",isSubNav:""},{default:V(()=>[m(ee,{favorites:u.value,accounts:p.value,categories:i.value,onForm:a[0]||(a[0]=_=>n(_)),onDelete:a[1]||(a[1]=_=>s(_))},null,8,["favorites","accounts","categories"]),m(D,{icon:b(I),onClick:n},null,8,["icon"]),m(U,{favorite:r.value,accounts:p.value,categories:i.value,onClose:o},null,8,["favorite","accounts","categories"]),m(P,{favorite:r.value,onClose:o},null,8,["favorite"])]),_:1}))}};export{ce as default};
