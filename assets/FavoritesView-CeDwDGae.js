import{X as E,_ as O,P as q}from"./FAB-D_x_lSjX.js";import{_ as I}from"./SubPageLayout-BIZCjP_o.js";import{r as v,G as L,j as C,c as $,o as i,w as F,i as u,f as r,N as U,t as g,O as A,p as y,v as k,F as w,q as j,g as N,s as S,u as _,x as B,J as M,k as z,m as x}from"./index-BBC1P1kV.js";import{_ as D}from"./Modal-Bbokac-i.js";import{_ as T}from"./TextField-DHM_XWB9.js";import{_ as h}from"./SelectField-B06SVX_c.js";import{_ as b}from"./RadioField-BqSE1Hbc.js";const J={class:"my-4 flex gap-2 justify-around"},G={class:"my-4 flex gap-2 justify-around"},P={__name:"Form",props:{favorite:{type:Object,default:null},accounts:{type:Array,default:()=>[]},categories:{type:Array,default:()=>[]}},emits:["close"],setup(f,{emit:d}){const c=f,p=d,m={id:null,label:"",amount:null,type:"Expense",categoryId:"",cardType:"Credit",accountId:""},t=v({...m});L(()=>c.favorite,s=>{s!=null&&s.id?t.value={...s}:t.value={...m}},{immediate:!0});const o=C(()=>{var s,a;return(a=(s=c.categories)==null?void 0:s.filter(e=>e.type==t.value.type))==null?void 0:a.map(e=>({label:e.name,value:e.id}))}),n=C(()=>{var s,a;return[{label:"Out Source / Cash",value:""},...(a=(s=c.accounts)==null?void 0:s.filter(e=>e.type==t.value.cardType))==null?void 0:a.map(e=>({label:e.name,value:e.id}))]}),l=async()=>{var e;const s=JSON.parse(JSON.stringify(t.value));s.id||delete s.id;const a=await U("favorites",s);a.success?((e=document.querySelector("#manage-favorites-form"))==null||e.close(),p("close")):console.error("Failed to save favorite:",a.error)};return(s,a)=>(i(),$(D,{id:"manage-favorites-form",modalTitle:"Favorite",isForm:"",submit:l,closeLabel:"Cancel"},{default:F(()=>[u(T,{modelValue:t.value.label,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.label=e),label:"Label",placeholder:"Grocery, Salary, Dinner..."},null,8,["modelValue"]),u(T,{modelValue:t.value.amount,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.amount=e),modelModifiers:{number:!0},label:"Amount",type:"number",placeholder:"0.00",required:""},null,8,["modelValue"]),r("div",J,[u(b,{modelValue:t.value.type,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.type=e),value:"Expense",name:"account-type"},null,8,["modelValue"]),u(b,{modelValue:t.value.type,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.type=e),value:"Income",name:"account-type"},null,8,["modelValue"])]),u(h,{modelValue:t.value.categoryId,"onUpdate:modelValue":a[4]||(a[4]=e=>t.value.categoryId=e),options:o.value,label:"Category",required:""},null,8,["modelValue","options"]),r("div",G,[u(b,{modelValue:t.value.cardType,"onUpdate:modelValue":a[5]||(a[5]=e=>t.value.cardType=e),value:"Credit",name:"card-type"},null,8,["modelValue"]),u(b,{modelValue:t.value.cardType,"onUpdate:modelValue":a[6]||(a[6]=e=>t.value.cardType=e),value:"Debit",name:"card-type"},null,8,["modelValue"])]),u(h,{modelValue:t.value.accountId,"onUpdate:modelValue":a[7]||(a[7]=e=>t.value.accountId=e),options:n.value,label:"Account",required:""},null,8,["modelValue","options"])]),_:1}))}},R={class:"font-bold text-center py-2"},X={__name:"DeleteForm",props:{favorite:{type:Object,default:null}},emits:["close"],setup(f,{emit:d}){const c=f,p=d,m=async()=>{var o;const t=await A("favorites",c.favorite.id);t.success?((o=document.querySelector("#delete-favorite-form"))==null||o.close(),p("close")):console.error("Failed to delete favorite:",t.error)};return(t,o)=>(i(),$(D,{id:"delete-favorite-form",modalTitle:"Delete Favorite",isForm:"",closeLabel:"Cancel",submit:m,isDanger:"",formButtonLabel:"Confirm"},{default:F(()=>{var n;return[o[0]||(o[0]=r("p",{class:"text-center text-balance"},"Are you sure you want to delete this favorite?",-1)),r("p",R,g(((n=f.favorite)==null?void 0:n.label)||"No Label"),1)]}),_:1}))}},H={class:"list bg-base-100 rounded-box shadow-md mb-6"},K=["onClick"],Q={key:1,class:"text-gray-400"},W={class:"flex gap-2 items-center mt-1"},Y={class:"text-xs font-semibold"},Z={key:1,class:"opacity-50"},ee=["onClick"],te={key:0},ae={class:"p-2"},oe={class:"alert alert-warning alert-soft"},le={__name:"List",props:["favorites","accounts","categories"],emits:["form","delete"],setup(f){const d=f,c=t=>{var o;return t?(o=d.accounts)==null?void 0:o.find(n=>n.id===t):null},p=t=>{var o;return t?(o=d.categories)==null?void 0:o.find(n=>n.id===t):null},m=C(()=>{const t=[];return d.favorites.forEach(o=>{o.account=c(o.accountId),o.category=p(o.categoryId),t.push(o)}),t.sort((o,n)=>{var l,s,a,e;return((l=o.category)==null?void 0:l.type)===((s=n.category)==null?void 0:s.type)?o.label.localeCompare(n.label):(((a=o.category)==null?void 0:a.type)||"").localeCompare(((e=n.category)==null?void 0:e.type)||"")})});return(t,o)=>{var n;return i(),y("div",null,[r("ul",H,[(i(!0),y(w,null,j(m.value,l=>(i(),y("li",{class:"list-row flex justify-between hover:bg-base-300 select-none",key:l.id},[r("div",{onClick:s=>t.$emit("form",l),class:"flex gap-4 w-full"},[r("div",null,[r("div",null,[l.label?(i(),y(w,{key:0},[N(g(l.label),1)],64)):(i(),y("span",Q,"No Label")),l.category?(i(),y("span",{key:2,class:S(["text-white ml-1",{"badge badge-sm badge-primary":l.category.type==="Income","badge badge-sm badge-error":l.category.type==="Expense"}])},g(`${l.category.name} (${l.category.type})`),3)):k("",!0)]),r("div",W,[r("div",Y,[N(g(_(B)(l.amount))+" ",1),l.account?(i(),y("span",{key:0,class:S({"text-warning":l.account.type==="Credit","text-secondary":l.account.type==="Debit"})},g(`${l.account.name} (${l.account.type})`),3)):(i(),y("span",Z,"Out Source"))])])])],8,K),r("button",{class:"btn btn-square btn-sm btn-ghost text-error",onClick:s=>t.$emit("delete",l)},[u(_(E),{size:"16"})],8,ee)]))),128)),(n=f.favorites)!=null&&n.length?k("",!0):(i(),y("li",te,[r("div",ae,[r("div",oe,[u(_(M),{size:"16"}),o[0]||(o[0]=r("span",null,"No favorites yet",-1))])])]))])])}}},se="favorites",pe={__name:"FavoritesView",setup(f){const d=v([]),c=v(null),p=v([]),m=v([]),t=async()=>{d.value=await x(se)},o=async()=>{p.value=await x("accounts"),m.value=await x("categories")},n=(a=null)=>{var e;c.value=a,(e=document.querySelector("#manage-favorites-form"))==null||e.showModal()},l=a=>{var e;c.value=a,(e=document.querySelector("#delete-favorite-form"))==null||e.showModal()},s=()=>{t()};return z(()=>{t(),o()}),(a,e)=>(i(),$(I,{pageTitle:"Favorites",isSubNav:""},{default:F(()=>[u(le,{favorites:d.value,accounts:p.value,categories:m.value,onForm:e[0]||(e[0]=V=>n(V)),onDelete:e[1]||(e[1]=V=>l(V))},null,8,["favorites","accounts","categories"]),u(O,{icon:_(q),onClick:n},null,8,["icon"]),u(P,{favorite:c.value,accounts:p.value,categories:m.value,onClose:s},null,8,["favorite","accounts","categories"]),u(X,{favorite:c.value,onClose:s},null,8,["favorite"])]),_:1}))}};export{pe as default};
